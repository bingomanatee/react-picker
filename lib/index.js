!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("prop-types"),require("@wonderlandlabs/looking-glass-engine"),require("lodash.isequal")):"function"==typeof define&&define.amd?define(["react","prop-types","@wonderlandlabs/looking-glass-engine","lodash.isequal"],t):(e=e||self).LGE=t(e.React,e.PropTypes,e.lookingGlassEngine,e.isEqual)}(this,(function(e,t,o,n){"use strict";var r="default"in e?e.default:e;function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function f(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=u(e);if(t){var r=u(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return d(this,o)}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],n=!0,r=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(n=(c=a.next()).done)&&(o.push(c.value),!t||o.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return o}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return g(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n;var E=r.createContext({}),b=function(e){var t=new Map;e.do.setListeningForPointers(!0),e.action("pointerDown",(function(e,o){var n=o.pointerId,r=o.clientX,i=o.clientY;t.set(n,{clientX:r,clientY:i,at:Date.now()}),setTimeout((function(){return t.delete(r)}),4e3)})),e.action("pointerMove",(function(e,o){var n=o.pointerId,r=o.clientX,i=o.clientY,c=t.get(n);if(c&&!c.dragging){var a=Math.abs(r-c.clientX),s=Math.abs(i-c.clientY);Math.max(a,s)>5&&(c.dragging=!0)}})),e.action("pointerEnd",(function(e,o){var n=o.pointerId,r=t.get(n);r&&(r.dragging||e.do.setDisplay(!1),t.delete(n))})),document&&document.addEventListener&&(document.addEventListener("pointerDown",e.do.pointerDown,!1),document.addEventListener("pointermove",e.do.pointerMove,!1),document.addEventListener("pointerend",e.do.pointerEnd,!1)),e.subscribe((function(){}),(function(){}),(function(){document&&document.removeEventListener&&(document.removeEventListener("pointerDown",e.do.pointerDown),document.removeEventListener("pointermove",e.do.pointerMove),document.removeEventListener("pointerend",e.do.pointerEnd))}))},C=function(e,t,o){return e&&"function"==typeof e[t]?e[t]:o},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new o.ValueStoreObject({options:e.options||[],choices:e.choices||[],display:!!e.display,chooseOne:!!e.chooseOne,comparator:C(e,"comparator",n),optionsFilter:C(e,"optionsFilter",(function(e){return h(e)})),optionToChoice:C(e,"optionsToChoice",(function(e){return e})),listeningForPointers:!1},{actions:{chooseOption:function(e,t){if(e.my.chooseOne){var o=e.my.optionToChoice(t);e.do.setChoices([o])}else e.do.toggleOption(t)},toggleOption:function(e,t){var o=e.my.optionToChoice(t);e.my.choices.some((function(t){return e.my.comparator(t,o)}))?e.my.chooseOne?e.do.setChoices([]):e.do.setChoices(e.my.choices.filter((function(t){return!e.my.comparator(t,o)}))):e.my.chooseOne?e.do.setChoices([o]):e.do.setChoices([].concat(h(e.my.choices),[o]))},toggleDisplay:function(e){e.do.setDisplay(!e.my.display)},addAll:function(e){e.do.setChoices(h(e.my.options))},remAll:function(e){e.do.setChoices([])}}}),r=new o.ValueStream(n);r.preprocess((function(e){if("function"!=typeof e)throw new Error("comparator only accepts functions");return e})),t.addStream("comparator",r);var i=new o.ValueStream((function(e){return h(e)}));i.preprocess((function(e){if("function"!=typeof e)throw new Error("comparator only accepts functions");return e})),t.addStream("optionsFilter",i);var c=new o.ValueStream((function(e){return e}));return c.preprocess((function(e){if("function"!=typeof e)throw new Error("comparator only accepts functions");return e})),t.addStream("optionToChoice",c),e.listenForPointers&&(b(t),t.do.setListeningForTouch(!0)),t},w=function(e){e.stopPropagation()},_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(s,e);var t,o,n,a=m(s);function s(){return i(this,s),a.apply(this,arguments)}return t=s,(o=[{key:"render",value:function(){return r.createElement("span",{onPointerDown:w},this.props.children)}}])&&c(t.prototype,o),n&&c(t,n),s}(e.PureComponent);function F(t){return e.createElement("svg",s({width:30,height:30},t),e.createElement("defs",null,e.createElement("radialGradient",{cx:"41.692%",cy:"37.355%",fx:"41.692%",fy:"37.355%",r:"91.272%",gradientTransform:"matrix(.7541 .62324 -.60098 .78203 .327 -.178)",id:"check-off_svg__a"},e.createElement("stop",{stopColor:"#FFF",offset:"0%"}),e.createElement("stop",{stopColor:"#FFF",offset:"28.096%"}),e.createElement("stop",{stopColor:"#D6D6D6",offset:"55.752%"}),e.createElement("stop",{stopColor:"#989898",offset:"100%"}))),e.createElement("rect",{width:28,height:27,rx:3,transform:"translate(1 1)",fill:"url(#check-off_svg__a)",fillRule:"evenodd"}))}function x(t){return e.createElement("svg",s({width:30,height:30},t),e.createElement("defs",null,e.createElement("radialGradient",{cx:"41.692%",cy:"37.355%",fx:"41.692%",fy:"37.355%",r:"91.272%",gradientTransform:"matrix(.7541 .62324 -.60098 .78203 .327 -.178)",id:"check-on_svg__a"},e.createElement("stop",{stopColor:"#FFF",offset:"0%"}),e.createElement("stop",{stopColor:"#FFF",offset:"28.096%"}),e.createElement("stop",{stopColor:"#D6D6D6",offset:"55.752%"}),e.createElement("stop",{stopColor:"#989898",offset:"100%"})),e.createElement("radialGradient",{cx:"41.692%",cy:"37.355%",fx:"41.692%",fy:"37.355%",r:"91.329%",gradientTransform:"scale(.96329 1) rotate(38.524 .425 .396)",id:"check-on_svg__b"},e.createElement("stop",{stopColor:"#FFF",offset:"0%"}),e.createElement("stop",{stopColor:"#FFF",offset:"28.096%"}),e.createElement("stop",{stopColor:"#D6D6D6",offset:"55.752%"}),e.createElement("stop",{stopColor:"#989898",offset:"100%"}))),e.createElement("g",{transform:"translate(-306 -288)",fill:"none",fillRule:"evenodd"},e.createElement("rect",{width:28,height:27,rx:3,transform:"translate(307 289)",fill:"url(#check-on_svg__a)"}),e.createElement("rect",{fill:"#7ED321",style:{mixBlendMode:"multiply"},x:307,y:289,width:28,height:27,rx:3}),e.createElement("path",{d:"M335 292v6.528l-13.463 13.463-5.444-5.444.03-.032-4.669-4.668 4.514-4.514 4.67 4.669 12.691-12.692A3 3 0 01335 292z",fill:"url(#check-on_svg__b)"})))}function D(t){return e.createElement("svg",s({width:30,height:30},t),e.createElement("defs",null,e.createElement("radialGradient",{cx:"41.692%",cy:"37.355%",fx:"41.692%",fy:"37.355%",r:"93.279%",gradientTransform:"matrix(.73787 .60983 -.56777 .79253 .321 -.177)",id:"radio-off_svg__a"},e.createElement("stop",{stopColor:"#FFF",offset:"0%"}),e.createElement("stop",{stopColor:"#FFF",offset:"28.096%"}),e.createElement("stop",{stopColor:"#D6D6D6",offset:"55.752%"}),e.createElement("stop",{stopColor:"#989898",offset:"100%"}))),e.createElement("ellipse",{cx:14.5,cy:13.5,rx:14.5,ry:13.5,transform:"translate(0 1)",fill:"url(#radio-off_svg__a)",fillRule:"evenodd"}))}function j(t){return e.createElement("svg",s({width:30,height:30},t),e.createElement("defs",null,e.createElement("radialGradient",{cx:"41.692%",cy:"37.355%",fx:"41.692%",fy:"37.355%",r:"95.312%",gradientTransform:"matrix(.72213 .59683 -.53714 .80237 .316 -.175)",id:"radio-on_svg__a"},e.createElement("stop",{stopColor:"#FFF",offset:"0%"}),e.createElement("stop",{stopColor:"#FFF",offset:"28.096%"}),e.createElement("stop",{stopColor:"#D6D6D6",offset:"55.752%"}),e.createElement("stop",{stopColor:"#989898",offset:"100%"})),e.createElement("radialGradient",{cx:"41.692%",cy:"37.355%",fx:"41.692%",fy:"37.355%",r:"97.074%",gradientTransform:"matrix(.70903 .586 -.51274 .81032 .313 -.173)",id:"radio-on_svg__b"},e.createElement("stop",{stopColor:"#FFF",offset:"0%"}),e.createElement("stop",{stopColor:"#FFF",offset:"40.81%"}),e.createElement("stop",{stopColor:"#989898",offset:"100%"}))),e.createElement("g",{transform:"translate(-306 -255)",fill:"none",fillRule:"evenodd"},e.createElement("ellipse",{cx:15,cy:13.5,rx:15,ry:13.5,transform:"translate(306 256)",fill:"url(#radio-on_svg__a)"}),e.createElement("ellipse",{fill:"#7ED321",style:{mixBlendMode:"multiply"},cx:321,cy:269.5,rx:15,ry:13.5}),e.createElement("path",{d:"M331.977 259.167c1.961 1.908 3.327 4.35 3.82 7.07l-13.746 13.744-5.444-5.444.03-.032-4.669-4.668 4.514-4.514 4.67 4.669z",fill:"url(#radio-on_svg__b)"})))}var P=function(t){var o,n=t.active,i=t.children,c=t.onClick,a=e.useContext(E).store;return o=n?a.my.chooseOne?j:x:a.my.chooseOne?D:F,r.createElement("div",{className:"picker__item",active:n,onClick:c},r.createElement(o,null),r.createElement("label",null,i))};P.propTypes={active:t.bool,children:t.elementType};var S=function(t){var o=t.Item,n=e.useContext(E),i=n.value,c=n.store;if(!i)return"";if(!i.display)return"";o||(o=P);var a=c.my.optionsFilter(i.options);return r.createElement("section",{className:"picker__container"},a.map((function(e){var t=i.choices.some((function(t){return c.my.comparator(t,e)})),n="string"==typeof e?e:e.label;return r.createElement(o,{store:c,active:t,option:e,onClick:function(){return c.do.chooseOption(e)}},n)})))};S.propTypes={Item:t.elementType};var T=Object.freeze({__proto__:null,ChoiceItem:P,ChoiceContainer:S}),k=function(t){var o=y(e.useState(!1),2),n=o[0],i=o[1],c=y(e.useState(null),2),a=c[0],s=c[1];e.useEffect((function(){var e=O(t);t.onStore&&t.onStore(e),i(e);var o,n=e.subscribe(s,(function(e){return console.log("error:",e)}));return t.onChoices&&(o=e.watch("choices").subscribe((function(e){var o=e.choices;return t.onChoices(o)}))),function(){n.unsubscribe(),o&&o.unsubscribe()}}),[]);var l=t.display,u=t.options,p=t.comparator,d=t.filterOptions;e.useEffect((function(){n&&"display"in t&&!!t.display!=!!n.my.display&&n.do.setDisplay(!!t.display)}),[l,n]),e.useEffect((function(){n&&Array.isArray(t.options)&&n.do.setOptions(t.options)}),[u,n]),e.useEffect((function(){n&&"function"==typeof p&&n.do.setComparator(p)}),[p,n]),e.useEffect((function(){n&&"function"==typeof d&&n.do.setFilterOptions(d)}),[d,n]);var m=f(f({},T),t),h=m.ChoiceContainer,v=m.ChoiceItem;return n&&a?r.createElement(E.Provider,{value:{value:a,store:n}},r.createElement(_,null,t.children,r.createElement(h,{Item:v}))):""};return k.propTypes={ChoiceContainer:t.elementType,ChoiceItem:t.elementType,options:t.arrayOf(t.oneOfType([t.string,t.shape({label:t.string})])),onChoices:t.func,onStore:t.func,display:t.bool,chooseOne:t.bool,filterOptions:t.func,comparator:t.func,children:t.any},k.defaultProps={options:[]},{Picker:k,ChoiceContext:E,CheckOn:x,CheckOff:F,RadioOn:j,RadioOff:D,choiceState:O}}));
