!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("prop-types"),require("@wonderlandlabs/looking-glass-engine"),require("lodash.isequal")):"function"==typeof define&&define.amd?define(["react","prop-types","@wonderlandlabs/looking-glass-engine","lodash.isequal"],t):(e=e||self).LGE=t(e.React,e.PropTypes,e.lookingGlassEngine,e.isEqual)}(this,(function(e,t,o,n){"use strict";var r="default"in e?e.default:e;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){c(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],n=!0,r=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(n=(c=a.next()).done)&&(o.push(c.value),!t||o.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return o}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return d(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;var y=r.createContext({}),m=function(e){return r.createElement("label",e,e.children)};function h(t){return e.createElement("svg",a({width:24,height:24},t),e.createElement("rect",{x:1,y:1,width:20,height:20,rx:6,transform:"translate(1 1)",fill:"#FFF",stroke:"#D6D6D6",strokeWidth:2,fillRule:"evenodd"}))}function b(t){return e.createElement("svg",a({width:24,height:24},t),e.createElement("g",{fill:"none",fillRule:"evenodd"},e.createElement("rect",{x:1,y:1,width:20,height:20,rx:6,transform:"translate(1 1)",fill:"#FFF",stroke:"#D6D6D6",strokeWidth:2}),e.createElement("path",{d:"M23 7v2.114L11.494 20.619 7.96 17.084l.366-.367-5.872-5.87L5.99 7.31l5.871 5.87 9.872-9.87A5.974 5.974 0 0123 7z",fill:"#335F00"})))}function v(t){return e.createElement("svg",a({width:24,height:24},t),e.createElement("circle",{cx:11,cy:11,r:10,transform:"translate(0 1)",fill:"#FFF",stroke:"#D6D6D6",strokeWidth:2,fillRule:"evenodd"}))}function C(t){return e.createElement("svg",a({width:24,height:24},t),e.createElement("g",{fill:"none",fillRule:"evenodd"},e.createElement("circle",{cx:11,cy:11,r:10,transform:"translate(1 1)",fill:"#FFF",stroke:"#D6D6D6",strokeWidth:2}),e.createElement("path",{d:"M20.734 5.311a10.947 10.947 0 012.128 4.942L11.495 21.619 7.96 18.084l.366-.367-5.872-5.87L5.99 8.31l5.871 5.87z",fill:"#417505"})))}var O=function(e){var t=e.active,o=e.chooseOne,n=e.label;return console.log("choiceItemIcon -- ",t,o,n),t?o?r.createElement(C,null):r.createElement(b,null):o?r.createElement(v,null):r.createElement(h,null)};O.propTypes={chooseOne:t.bool,active:t.bool},O.defaultProps={active:!1,chooseOne:!1};var E=function(t){var o=t.active,n=t.children,i=t.onClick,c=t.disabled,a=t.ChoiceItemIcon,l=void 0===a?O:a,s=t.ChoiceItemLabel||m,u=e.useContext(y).store.my.chooseOne;return r.createElement("div",{className:"picker__item",active:o,disabled:c,onClick:function(){c||i.apply(void 0,arguments)}},r.createElement(l,{chooseOne:u,active:o,label:n,disabled:c}),r.createElement(s,{active:o,disabled:c},n))};E.propTypes={DefaultLabel:t.any,DefaultIcon:t.any,active:t.bool,children:t.any,disabled:t.bool,onClick:t.func,iconOn:t.any,iconOff:t.any},E.defaultProps={active:!1,disabled:!1,iconOn:null,iconOff:null};var g=function(e){var t=e.children;return r.createElement("p",{className:"picker__empty"},t||"no options")},k=function(e){var t=e.children;return r.createElement("section",{className:"picker__container"},t)};k.propTypes={children:t.any};var I=function(t){var o=t.ChoiceItem,n=void 0===o?n:o,i=t.ChoiceMenu,c=void 0===i?c:i,a=t.EmptyMessage,l=void 0===a?l:a,s=t.ChoiceItemIcon,u=t.ChoiceItemLabel,f=e.useContext(y),p=f.value,d=f.store;if(!p)return"";if(!p.display)return"";var m=d.my.optionsFilter(p.options,p,d);return m&&m.length?r.createElement(c,{displayedOptions:m},m.map((function(e,t){var o=p.choices.some((function(t){return d.my.comparator(t,e)})),i=d.my.optionToLabel(e,t,d);return r.createElement(n,{key:"".concat(i,"_").concat(t),store:d,active:o,option:e,ChoiceItemIcon:s,ChoiceItemLabel:u,disabled:d.my.optionDisabled(e,t,d),onClick:function(){return d.do.chooseOption(e)}},d.my.optionToLabel(e,t,d))}))):r.createElement(c,null,r.createElement(l,{onClick:function(){return d.do.setDisplay(!1)}},"No Choices"))};I.propTypes={ChoiceItem:t.any,ChoiceMenu:t.any,EmptyMessage:t.any},I.defaultProps={ChoiceItem:E,EmptyMessage:g,ChoiceMenu:k};var D=function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"===i(e)){if("label"in e)return e.label;if("function"==typeof e.toString)return e.toString()}return"".concat(e)},w=function(e){return e},j=function(e){return f(e)},S=function(){return!1},M=function(e,t,o){return e&&"function"==typeof e[t]?e[t]:o},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=M(e,"optionsFilter",j),r=M(e,"optionToChoice",w),i=M(e,"comparator",n),c=M(e,"optionToLabel",D),a=M(e,"optionDisabled",S),l=e.options||[],s=e.choices||[],u=o.addActions(new o.ValueObjectStream({options:l,choices:s,display:!!e.display,chooseOne:!!e.chooseOne,comparator:i,optionsFilter:t,optionToChoice:r,optionToLabel:c,optionDisabled:a,closeOnClick:!!e.closeOnClick}),{chooseOption:function(e,t){if(e.my.chooseOne){var o=e.my.optionToChoice(t);e.do.setChoices([o])}else e.do.toggleOption(t)},addOption:function(e,t){var o=e.my.optionToChoice(t);e.my.chooseOne?e.do.setChoices([o]):e.my.choices.some((function(t){return e.my.comparator(t,o)}))||e.do.setChoices([].concat(f(e.my.choices),[o]))},toggleOption:function(e,t){var o=e.my.optionToChoice(t);e.my.choices.some((function(t){return e.my.comparator(t,o)}))?e.my.chooseOne?e.do.setChoices([]):e.do.setChoices(e.my.choices.filter((function(t){return!e.my.comparator(t,o)}))):e.my.chooseOne?e.do.setChoices([o]):e.do.setChoices([].concat(f(e.my.choices),[o]))},toggleDisplay:function(e){e.do.setDisplay(!e.my.display)},addAll:function(e){e.do.setChoices(f(e.my.options))},remAll:function(e){e.do.setChoices([])}});return u.addFieldSubject("options",new o.ValueStream(l)),u.addFieldSubject("choices",new o.ValueStream(s)),u},P=function e(t){try{if(!t)return;t.stopPropogation&&t.stopPropogation(),t.preventDefault&&t.preventDefault(),t.nativeEvent&&e(t.nativeEvent)}catch(e){console.log("snuff error: ",e)}},F=function(e){var t=e.children;return r.createElement("span",{onClick:P,onMouseDown:P,onMouseUp:P,onMouseLeave:P,onMouseMove:P,onKeyDown:P,onKeyUp:P,onPointerDown:P,onPointerMove:P,onPointerLeave:P},t)},T=function(){return""},A=function(t){var o=t.store,n=t.children,i=e.useRef(null),c=e.useCallback((function(){o.my.display&&o.do.setDisplay(!1)})),a=e.useCallback((function(e){"Escape"===e.key&&c()}),[]),l=e.useCallback((function(e){if(i.current&&!i.current.contains(e.target)){for(var t=e.target;t;){if("svg"===t.nodeName)return;if(t.dataset&&t.dataset.closer)return;t=t.parentNode||t.parent}c()}}),[i.current]);return e.useEffect((function(){return setTimeout((function(){document.addEventListener("click",l),document.addEventListener("keyup",a)}),500),function(){document.removeEventListener("click",l),document.removeEventListener("keyup",a)}}),[]),r.createElement("div",{"data-closer":!0,ref:i},n)},x={ChoiceItem:E,ChoiceMenu:k,EmptyMessage:g,ChoiceContainer:I,Header:T,Footer:T},R=function(t){var o=u(e.useState(!1),2),n=o[0],i=o[1],c=u(e.useState(null),2),a=c[0],l=c[1];e.useEffect((function(){var e=L(t);t.onStore&&t.onStore(e),i(e);var o,n=e.subscribe(l,(function(e){return console.log("picker store error:",e)}));return t.onChoices&&(o=e.watch("choices").subscribe((function(e){var o=e.choices;return t.onChoices(o)}))),function(){n.unsubscribe(),o&&o.unsubscribe(),e.complete()}}),[]);var f=t.display,p=t.options,d=t.comparator,m=t.filterOptions,h=t.optionDisabled;e.useEffect((function(){n&&"display"in t&&!!t.display!=!!n.my.display&&n.do.setDisplay(!!t.display)}),[f,n]),e.useEffect((function(){n&&Array.isArray(t.options)&&n.do.setOptions(t.options)}),[p,n]),e.useEffect((function(){n&&"function"==typeof d&&n.do.setComparator(d)}),[d,n]),e.useEffect((function(){n&&"function"==typeof h&&n.do.setOptionDisabled(h)}),[h,n]),e.useEffect((function(){n&&"function"==typeof m&&n.do.setFilterOptions(m)}),[m,n]);var b=s(s({},x),t),v=b.ChoiceContainer,C=b.ChoiceMenu,O=b.ChoiceItem,E=b.EmptyMessage,g=b.ChoiceItemIcon,k=b.ChoiceItemLabel,I=b.Header,D=b.Footer;if(!n||!a)return"";return r.createElement(y.Provider,{value:{value:a,store:n}},r.createElement(F,null,I?r.createElement(I,{store:n,value:a}):"","function"==typeof t.children?t.children({value:a,store:n}):t.children,function(e){return e.my.display?e.my.closeOnClick?r.createElement(A,{store:e},r.createElement(v,{ChoiceItemIcon:g,ChoiceItemLabel:k,ChoiceItem:O,ChoiceMenu:C,EmptyMessage:E})):r.createElement(v,{ChoiceItemIcon:g,ChoiceItemLabel:k,ChoiceItem:O,ChoiceMenu:C,EmptyMessage:E}):""}(n),D?r.createElement(D,{store:n,value:a}):""))};return R.propTypes={Header:t.any,Footer:t.any,ChoiceContainer:t.any,ChoiceItem:t.any,ChoiceItemLabel:t.any,ChoiceItemIcon:t.any,ChoiceMenu:t.any,EmptyMessage:t.any,options:t.arrayOf(t.any),choices:t.arrayOf(t.any),display:t.bool,closeOnClick:t.bool,chooseOne:t.bool,filterOptions:t.func,comparator:t.func,optionToLabel:t.func,optionToChoice:t.func,optionDisabled:t.func,onChoices:t.func,onStore:t.func,children:t.any},R.defaultProps={options:[],closeOnClick:!0,display:!1,chooseOne:!1,onStore:null,onChoices:null,optionToLabel:function(e){return null===e?"Null":"object"===i(e)?"label,name,value,id".split(",").reduce((function(t,o){return t||(o in e?e[o]:t)}),"")||"Unlabelled":"".concat(e)},optionToChoice:function(e){return null===e?null:"object"===i(e)?s({},e):e}},{Picker:R,ChoiceContext:y,CheckOn:b,CheckOff:h,RadioOn:C,RadioOff:v,storeFactory:L,ChoiceItem:E,EmptyMessage:g}}));
